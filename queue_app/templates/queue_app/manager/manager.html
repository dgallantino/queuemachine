{% extends "queue_app/manager/manager_base.html" %}
{% load static %}
{% block title %}Manager{% endblock %}
{% block stylesheet-content %}
	<link href="{% static 'queue_app/core/css/manager.css'%}" rel="stylesheet" type="text/css">
	<link href="{% static 'queue_app/bootstrap-table/src/bootstrap-table.css'%}" rel="stylesheet" type="text/css">
{% endblock %}
{% block head_script %}
<script src="{% static 'queue_app/bootstrap-table/src/bootstrap-table.js' %}"></script>
{% endblock %}
{% block javascript-content %}
<script type="text/javascript">

$('.queue-list-table').as_queue_list();
//setInterval(function(){
//	$('.queue-list-table').as_queue_list();
//},5*60*1000);
$('.btn.btn-refresh').click(function(event){
	event.preventDefault();
	$(this).parent().find('.queue-list-table').as_queue_list();
});

$('body').tooltip({
    selector: '[data-toggle="tooltip"]'
});

</script>
{% endblock %}

{% block content-main %}
<div class="row">
	<div class="col-3">				
		<div class="nav flex-column nav-pills sticky-top" id="v-pills-tab" role="tablist" aria-orientation="vertical" >
		{% for service in services %}
			<a class="nav-link text-capitalize {{ forloop.first|yesno:"active,," }}" id="tab_{{ service.id }}" data-toggle="pill" href="#tabContent_{{ service.id }}" role="tab" aria-controls="tabContent_{{ service.id }}" aria-selected="{{ forloop.first }}">
				{{ service.name }} <span class="badge badge-secondary"></span>
			</a>
		{% empty %}
			<span><i class="fa fa-close"></i>Make atleast one service</span>
    	{% endfor %}
    	</div>
	</div>
  	<div class="col-9">
    	<div class="tab-content" id="v-pills-tabContent">
    	{% for service in services %}
      		<div class="tab-pane fade {{ forloop.first|yesno:"show active," }}" id="tabContent_{{ service.id }}" role="tabpanel" aria-labelledby="tab_{{ service.id }}" >
      			<a class="btn btn-primary btn-refresh" href="#" role="button" style="margin-bottom:10px" data-toggle="tooltip" data-placement="bottom" title="Refresh queue table">Refresh</a>
  				<table id="tabTable_{{ service.id }}" class="table table-sm" data-toggle="#tabTable_{{ service.id }}" >
					<thead>
  						<tr>
  							<td rowspan="2">
  								#
  							</td>
  							<td class="text-center" colspan="4">
  								Queue Detail
  							</td>
  						</tr>
  						<tr>
  							<td>
  								Ticket
  							</td>
  							<td>
  								Booking Time
  							</td>
  							<td>
  								Customer
  							</td>
  							<td>
  								Actions
  							</td>
  						</tr>
					</thead>
					<tbody class="queue-list-table" queues_url="{% url 'queue:queue_per_service_url' service.id %}">
						<tr>
							<td class ="text-center" colspan="5">
								<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
								<span class="sr-only">Loading...</span>
							</td>
						</tr>
					</tbody>
  				</table>
      		</div>
    	{% endfor %}
		</div>
	</div>
</div>

{% endblock %}